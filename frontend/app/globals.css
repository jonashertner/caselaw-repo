@import "../styles/design-tokens.css";

@tailwind base;
@tailwind components;
@tailwind utilities;

html {
  height: 100%;
  -webkit-text-size-adjust: 100%;
}

body {
  min-height: 100%;
  background-color: var(--color-bg);
  color: var(--color-fg);
  font-family: var(--font-sans);
  font-size: 16px;
  line-height: 1.5;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-tap-highlight-color: transparent;
}

/* Safe area helpers */
.safe-area-top {
  height: env(safe-area-inset-top);
}

.safe-area-bottom {
  height: env(safe-area-inset-bottom);
}

/* Links */
a {
  color: var(--color-accent);
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

/* Form inputs */
input, select, textarea {
  border: 1px solid var(--color-border);
  background-color: var(--color-bg-elevated);
  color: var(--color-fg);
  padding: 0.75rem 1rem;
  font-size: 1rem;
  border-radius: var(--radius-lg);
  transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
  -webkit-appearance: none;
  appearance: none;
}

input:focus, select:focus, textarea:focus {
  outline: none;
  border-color: var(--color-accent);
  box-shadow: 0 0 0 3px var(--color-focus-ring);
}

input::placeholder, textarea::placeholder {
  color: var(--color-fg-faint);
}

@media (min-width: 1024px) {
  input, select, textarea {
    padding: 0.5rem 0.75rem;
    font-size: 0.875rem;
  }
}

input[type="checkbox"] {
  height: 1.25rem;
  width: 1.25rem;
  border-radius: var(--radius-sm);
  border: 2px solid var(--color-border);
  background-color: var(--color-bg-elevated);
  min-width: 20px;
  min-height: 20px;
  accent-color: var(--color-accent);
  cursor: pointer;
}

input[type="checkbox"]:checked {
  background-color: var(--color-accent);
  border-color: var(--color-accent);
}

input[type="date"] {
  min-height: 48px;
}

@media (min-width: 1024px) {
  input[type="date"] {
    min-height: auto;
  }
}

select {
  cursor: pointer;
  padding-right: 2.5rem;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23737373'%3E%3Cpath stroke-linecap='round' stroke-width='2' d='M19 9l-7 7-7-7'/%3E%3C/svg%3E");
  background-position: right 0.75rem center;
  background-repeat: no-repeat;
  background-size: 1rem;
}

[data-theme="dark"] select {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23a3a3a3'%3E%3Cpath stroke-linecap='round' stroke-width='2' d='M19 9l-7 7-7-7'/%3E%3C/svg%3E");
}

@media (prefers-color-scheme: dark) {
  :root:not([data-theme]) select {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23a3a3a3'%3E%3Cpath stroke-linecap='round' stroke-width='2' d='M19 9l-7 7-7-7'/%3E%3C/svg%3E");
  }
}

button {
  font-family: inherit;
  -webkit-tap-highlight-color: transparent;
}

/* Scrollbar */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  background: var(--color-scrollbar-track);
}

::-webkit-scrollbar-thumb {
  background: var(--color-scrollbar-thumb);
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--color-scrollbar-thumb-hover);
}

/* Selection */
::selection {
  background-color: var(--color-selection-bg);
  color: var(--color-selection-fg);
}

/* Line clamp */
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.line-clamp-3 {
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Animations */
@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes fadeOut {
  from { opacity: 1; }
  to { opacity: 0; }
}

@keyframes slideInFromBottom {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideInFromTop {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideInFromRight {
  from {
    opacity: 0;
    transform: translateX(10px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes scaleIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

.animate-spin {
  animation: spin 1s linear infinite;
}

.animate-fade-in {
  animation: fadeIn var(--transition-normal) ease-out;
}

.animate-fade-out {
  animation: fadeOut var(--transition-normal) ease-out;
}

.animate-slide-in-bottom {
  animation: slideInFromBottom var(--transition-normal) ease-out;
}

.animate-slide-in-top {
  animation: slideInFromTop var(--transition-normal) ease-out;
}

.animate-slide-in-right {
  animation: slideInFromRight var(--transition-normal) ease-out;
}

.animate-scale-in {
  animation: scaleIn var(--transition-normal) ease-out;
}

.animate-pulse {
  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

/* Prevent overscroll bounce on iOS */
@supports (-webkit-touch-callout: none) {
  body {
    overscroll-behavior-y: none;
  }
}

/* Focus visible styles */
.focus-ring:focus-visible {
  outline: none;
  box-shadow: 0 0 0 3px var(--color-focus-ring);
}

/* Custom utility classes */
.bg-elevated {
  background-color: var(--color-bg-elevated);
}

.bg-subtle {
  background-color: var(--color-bg-subtle);
}

.bg-muted {
  background-color: var(--color-bg-muted);
}

.text-muted {
  color: var(--color-fg-muted);
}

.text-subtle {
  color: var(--color-fg-subtle);
}

.text-faint {
  color: var(--color-fg-faint);
}

.border-default {
  border-color: var(--color-border);
}

.border-subtle {
  border-color: var(--color-border-subtle);
}

.border-strong {
  border-color: var(--color-border-strong);
}

/* Relevance bar gradient */
.relevance-bar {
  background: linear-gradient(90deg,
    var(--color-accent) 0%,
    var(--color-success) 50%,
    var(--color-success) 100%
  );
}

/* Toast animations */
@keyframes toast-enter {
  from {
    opacity: 0;
    transform: translateY(-100%) scale(0.9);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes toast-exit {
  from {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
  to {
    opacity: 0;
    transform: translateY(-100%) scale(0.9);
  }
}

.toast-enter {
  animation: toast-enter 0.3s ease-out forwards;
}

.toast-exit {
  animation: toast-exit 0.2s ease-in forwards;
}

/* Command palette overlay */
@keyframes overlay-show {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes dialog-show {
  from {
    opacity: 0;
    transform: translate(-50%, -48%) scale(0.96);
  }
  to {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
}

.overlay-animate {
  animation: overlay-show 0.2s ease-out;
}

.dialog-animate {
  animation: dialog-show 0.2s ease-out;
}

/* Reading progress bar */
.reading-progress {
  background: linear-gradient(90deg, var(--color-accent) var(--progress, 0%), transparent 0%);
}

/* Highlight colors for annotations */
.highlight-yellow {
  background-color: rgba(250, 204, 21, 0.4);
}

.highlight-green {
  background-color: rgba(34, 197, 94, 0.3);
}

.highlight-blue {
  background-color: rgba(59, 130, 246, 0.3);
}

.highlight-pink {
  background-color: rgba(236, 72, 153, 0.3);
}

.highlight-purple {
  background-color: rgba(168, 85, 247, 0.3);
}

[data-theme="dark"] .highlight-yellow {
  background-color: rgba(250, 204, 21, 0.25);
}

[data-theme="dark"] .highlight-green {
  background-color: rgba(34, 197, 94, 0.2);
}

[data-theme="dark"] .highlight-blue {
  background-color: rgba(59, 130, 246, 0.2);
}

[data-theme="dark"] .highlight-pink {
  background-color: rgba(236, 72, 153, 0.2);
}

[data-theme="dark"] .highlight-purple {
  background-color: rgba(168, 85, 247, 0.2);
}

/* Swipe gesture feedback */
.swipe-action-save {
  background: linear-gradient(90deg, var(--color-success-subtle) 0%, transparent 100%);
}

.swipe-action-preview {
  background: linear-gradient(-90deg, var(--color-accent-subtle) 0%, transparent 100%);
}
